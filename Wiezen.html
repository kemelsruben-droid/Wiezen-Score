<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Wiezen Scorebord</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX/TSX transformation in browser -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Google Fonts -->
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&family=JetBrains+Mono:wght@500;700&display=swap');
      
      body { 
        font-family: 'Inter', sans-serif; 
        -webkit-tap-highlight-color: transparent;
      }
      
      /* Animation Utilities */
      .animate-fade-in { animation: fadeIn 0.3s ease-out forwards; }
      .animate-fade-in-up { animation: fadeInUp 0.5s ease-out forwards; }
      .animate-bounce-slow { animation: bounce 3s infinite; }
      
      @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
      }
      
      @keyframes fadeInUp {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
      }

      /* Scrollbar hiding for clean look */
      .no-scrollbar::-webkit-scrollbar {
        display: none;
      }
      .no-scrollbar {
        -ms-overflow-style: none;
        scrollbar-width: none;
      }
      
      /* Gradient Text Utility */
      .text-gradient-gold {
        background: linear-gradient(to right, #facc15, #d97706);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
      }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.2.3",
    "react-dom/": "https://esm.sh/react-dom@^19.2.3/",
    "react/": "https://esm.sh/react@^19.2.3/"
  }
}
</script>
</head>
<body class="bg-slate-900 text-slate-100 h-screen overflow-hidden select-none">
    <div id="root" class="h-full w-full"></div>

    <!-- MAIN APPLICATION SCRIPT -->
    <script type="text/babel" data-presets="typescript,react">
        const { useState, useEffect } = React;

        // ==========================================
        // CONSTANTS & CONFIG
        // ==========================================
        
        const POINTS = {
          ALLEEN_BASE: 2,
          ALLEEN_REQ: 5,
          VRAAG_BASE: 2,
          VRAAG_REQ: 8,
          TROEL_BASE: 4,
          TROEL_REQ: 8,
          TROEL_ALL_BONUS: 20, // If 13 tricks
          ABONDANCE_9: 4,
          ABONDANCE_10: 7,
          ABONDANCE_11: 8,
          ABONDANCE_12: 9,
          MISERIE: 7,
          OPEN_MISERIE: 14,
          SOLO: 25,
          SOLO_SLIM: 30
        };

        const GAME_LABELS = {
          'PAS': 'Iedereen Past',
          'ALLEEN': 'Alleen (5+)',
          'VRAAG': 'Vraag & Mee (8+)',
          'TROEL': 'Troel (8+)',
          'ABONDANCE_9': 'Abondance (9)',
          'ABONDANCE_10': 'Abondance (10)',
          'ABONDANCE_11': 'Abondance (11)',
          'ABONDANCE_12': 'Abondance (12)',
          'MISERIE': 'Miserie',
          'OPEN_MISERIE': 'Open Miserie',
          'SOLO': 'Solo (13)',
          'SOLO_SLIM': 'Solo Slim (13)'
        };

        const INITIAL_PLAYERS = [
          { id: 0, name: 'Speler 1', score: 0 },
          { id: 1, name: 'Speler 2', score: 0 },
          { id: 2, name: 'Speler 3', score: 0 },
          { id: 3, name: 'Speler 4', score: 0 },
        ];

        // ==========================================
        // LOGIC
        // ==========================================

        const calculateRoundScore = (gameType, tricks, success) => {
          // 1. Miserie Types (Fixed Success/Fail)
          if (gameType === 'MISERIE') return POINTS.MISERIE;
          if (gameType === 'OPEN_MISERIE') return POINTS.OPEN_MISERIE;

          // 2. Fixed High Contracts
          if (gameType === 'ABONDANCE_9') return POINTS.ABONDANCE_9;
          if (gameType === 'ABONDANCE_10') return POINTS.ABONDANCE_10;
          if (gameType === 'ABONDANCE_11') return POINTS.ABONDANCE_11;
          if (gameType === 'ABONDANCE_12') return POINTS.ABONDANCE_12;
          if (gameType === 'SOLO') return POINTS.SOLO;
          if (gameType === 'SOLO_SLIM') return POINTS.SOLO_SLIM;

          // 3. Variable Trick Contracts
          let base = 0;
          let required = 0;
          let perOverTrick = 1;
          let isTroel = false;
          let isVraag = false;

          if (gameType === 'ALLEEN') {
            base = POINTS.ALLEEN_BASE;
            required = POINTS.ALLEEN_REQ; // 5
            perOverTrick = 1;
          } else if (gameType === 'VRAAG') {
            base = POINTS.VRAAG_BASE;
            required = POINTS.VRAAG_REQ; // 8
            perOverTrick = 1;
            isVraag = true;
          } else if (gameType === 'TROEL') {
            base = POINTS.TROEL_BASE;
            required = POINTS.TROEL_REQ; // 8
            perOverTrick = 2; 
            isTroel = true;
          }

          if (success) {
            // Special Rule: Troel 13 tricks = 20p
            if (isTroel && tricks === 13) return POINTS.TROEL_ALL_BONUS;
            
            // Special Rule: Vraag 13 tricks = Double points
            let points = base + ((tricks - required) * perOverTrick);
            if (isVraag && tricks === 13) points *= 2;
            
            return points;
          } else {
            // Failed
            const short = required - tricks;
            let points = base + (short * perOverTrick);
            return points;
          }
        };

        // ==========================================
        // ICONS
        // ==========================================
        
        const CrownIcon = () => (
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" className="w-6 h-6 text-yellow-400 drop-shadow-md">
            <path fillRule="evenodd" d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z" clipRule="evenodd" />
          </svg>
        );

        const UserIcon = () => (
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" className="w-5 h-5">
            <path fillRule="evenodd" d="M7.5 6a4.5 4.5 0 119 0 4.5 4.5 0 01-9 0zM3.751 20.105a8.25 8.25 0 0116.498 0 .75.75 0 01-.437.695A18.683 18.683 0 0112 22.5c-2.786 0-5.433-.608-7.812-1.7a.75.75 0 01-.437-.695z" clipRule="evenodd" />
          </svg>
        );

        const PlusIcon = () => (
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={2.5} stroke="currentColor" className="w-6 h-6">
            <path strokeLinecap="round" strokeLinejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
          </svg>
        );

        // ==========================================
        // APP COMPONENT
        // ==========================================

        function App() {
          // Screens: 'SETUP' | 'SCOREBOARD' | 'ADD_ROUND' | 'FINISH'
          const [screen, setScreen] = useState('SETUP');
          const [players, setPlayers] = useState(INITIAL_PLAYERS);
          const [history, setHistory] = useState([]);
          
          // Multiplier Logic (x2 after Pass)
          const [multiplier, setMultiplier] = useState(1);
          
          // Add Round Form State
          const [selectedGame, setSelectedGame] = useState('VRAAG');
          const [bidder, setBidder] = useState(0);
          const [partner, setPartner] = useState(1);
          const [tricks, setTricks] = useState(8);
          const [miserieSuccess, setMiserieSuccess] = useState(true);

          // --- Actions ---

          const updateName = (id, name) => {
            setPlayers(prev => prev.map(p => p.id === id ? { ...p, name } : p));
          };

          const startGame = () => setScreen('SCOREBOARD');

          const handlePass = () => {
            const passEntry = {
              id: Date.now().toString(),
              gameType: 'PAS',
              tricks: 0,
              success: true,
              points: 0,
              multiplier: multiplier,
              timestamp: Date.now()
            };
            
            setHistory(prev => [passEntry, ...prev]);
            setMultiplier(prev => prev * 2);
          };

          const addRound = () => {
            let isSuccess = false;
            let required = 0;

            switch(selectedGame) {
              case 'MISERIE':
              case 'OPEN_MISERIE':
                isSuccess = miserieSuccess; 
                break;
              case 'VRAAG':
              case 'TROEL':
                required = 8;
                isSuccess = tricks >= required;
                break;
              case 'ALLEEN':
                required = 5;
                isSuccess = tricks >= required;
                break;
              case 'ABONDANCE_9': required = 9; isSuccess = tricks >= required; break;
              case 'ABONDANCE_10': required = 10; isSuccess = tricks >= required; break;
              case 'ABONDANCE_11': required = 11; isSuccess = tricks >= required; break;
              case 'ABONDANCE_12': required = 12; isSuccess = tricks >= required; break;
              case 'SOLO':
              case 'SOLO_SLIM':
                required = 13;
                isSuccess = tricks === 13;
                break;
              default:
                break;
            }

            let stake = calculateRoundScore(selectedGame, tricks, isSuccess);
            
            const currentMultiplier = multiplier;
            stake = stake * currentMultiplier;

            const newPlayers = [...players];
            const isPartnership = (selectedGame === 'VRAAG' || selectedGame === 'TROEL');
            const sign = isSuccess ? 1 : -1;

            if (isPartnership) {
               newPlayers.forEach(p => {
                 if (p.id === bidder || p.id === partner) {
                   p.score += (stake * sign);
                 } else {
                   p.score -= (stake * sign);
                 }
               });
            } else {
               newPlayers.forEach(p => {
                 if (p.id === bidder) {
                   p.score += (stake * 3 * sign);
                 } else {
                   p.score -= (stake * sign);
                 }
               });
            }

            setPlayers(newPlayers);
            setHistory(prev => [{
              id: Date.now().toString(),
              gameType: selectedGame,
              bidder,
              partner: isPartnership ? partner : undefined,
              tricks: tricks,
              success: isSuccess,
              points: stake,
              multiplier: currentMultiplier,
              timestamp: Date.now()
            }, ...prev]);

            setMultiplier(1);
            setScreen('SCOREBOARD');
          };

          const handleFinish = () => setScreen('FINISH');

          const resetGame = () => {
            setPlayers(prev => prev.map(p => ({ ...p, score: 0 })));
            setHistory([]);
            setMultiplier(1);
            setScreen('SETUP');
          };

          // --- Render Methods ---

          const renderSetup = () => (
            <div className="flex flex-col items-center justify-center min-h-screen p-6 bg-gradient-to-br from-slate-900 to-slate-800 text-white">
              <div className="text-center mb-10 animate-bounce-slow">
                 <div className="text-6xl mb-2">‚ô†Ô∏è ‚ô•Ô∏è ‚ô£Ô∏è ‚ô¶Ô∏è</div>
              </div>
              <h1 className="text-5xl md:text-7xl font-bold mb-8 text-gradient-gold drop-shadow-sm tracking-tight text-center">
                Wiezen
              </h1>
              
              <div className="bg-white/5 backdrop-blur-xl p-8 rounded-3xl shadow-2xl w-full max-w-md border border-white/10 ring-1 ring-white/5">
                <h2 className="text-xl text-slate-300 mb-6 font-semibold text-center uppercase tracking-widest">Spelers</h2>
                <div className="space-y-4">
                  {players.map(p => (
                    <div key={p.id} className="relative group">
                      <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-slate-400">
                         <UserIcon />
                      </div>
                      <input
                        type="text"
                        value={p.name}
                        onChange={(e) => updateName(p.id, e.target.value)}
                        className="w-full bg-slate-900/60 text-white border border-slate-700 rounded-xl py-4 pl-10 pr-4 focus:border-yellow-500 focus:ring-2 focus:ring-yellow-500/20 focus:outline-none transition-all placeholder-slate-500 font-medium"
                        placeholder={`Naam speler ${p.id + 1}`}
                      />
                    </div>
                  ))}
                </div>
                <button 
                  onClick={startGame}
                  className="w-full mt-8 bg-gradient-to-r from-yellow-500 to-amber-600 hover:from-yellow-400 hover:to-amber-500 text-slate-900 font-bold py-4 rounded-xl shadow-lg shadow-yellow-500/20 transform transition-all active:scale-[0.98] text-xl"
                >
                  Start Spel
                </button>
              </div>
            </div>
          );

          const renderScoreboard = () => {
            const maxScore = Math.max(...players.map(p => p.score));
            
            return (
            <div className="flex flex-col h-screen bg-slate-900 text-slate-100 overflow-hidden font-sans">
              <div className="absolute inset-0 bg-gradient-to-b from-slate-900 via-[#1e293b] to-slate-900 opacity-80 z-0 pointer-events-none"></div>

              <div className="relative z-10 bg-slate-900/80 backdrop-blur-md border-b border-white/5 p-4 flex justify-between items-center shadow-lg">
                <div className="flex items-center gap-3">
                     <div className="w-10 h-10 bg-gradient-to-br from-yellow-500 to-amber-600 rounded-lg flex items-center justify-center text-slate-900 font-bold text-xl shadow-lg">W</div>
                     <div className="flex flex-col">
                        <h1 className="font-bold text-lg leading-tight text-slate-100">Wiezen Score</h1>
                        {multiplier > 1 ? (
                            <span className="text-xs font-bold text-yellow-400 animate-pulse">
                               VOLGENDE RONDE x{multiplier}
                            </span>
                        ) : (
                            <span className="text-xs text-slate-400">Ronde {history.length + 1}</span>
                        )}
                     </div>
                </div>
                <button onClick={handleFinish} className="bg-rose-500/10 hover:bg-rose-500/20 text-rose-500 border border-rose-500/50 px-4 py-2 rounded-full font-bold text-xs transition-colors">
                    Stop Spel
                </button>
              </div>

              <div className="relative z-10 grid grid-cols-4 gap-2 p-2 sm:p-4">
                {players.map(p => {
                  const isLeader = p.score === maxScore && p.score > 0;
                  return (
                  <div key={p.id} className={`
                      relative flex flex-col items-center justify-center p-3 sm:p-4 rounded-2xl border transition-all duration-300
                      ${isLeader 
                         ? 'bg-gradient-to-b from-yellow-500/20 to-amber-600/5 border-yellow-500/50 shadow-[0_0_15px_rgba(234,179,8,0.2)]' 
                         : 'bg-white/5 border-white/10 hover:bg-white/10'}
                  `}>
                    {isLeader && <div className="absolute -top-3 animate-bounce"><CrownIcon /></div>}
                    <span className="text-xs sm:text-sm text-slate-400 uppercase font-bold truncate w-full text-center mb-1">{p.name}</span>
                    <span className={`text-2xl sm:text-3xl lg:text-4xl font-mono font-bold tracking-tighter ${p.score >= 0 ? 'text-emerald-400' : 'text-rose-400'}`}>
                      {p.score > 0 ? '+' : ''}{p.score}
                    </span>
                  </div>
                )})}
              </div>

              {multiplier > 1 && (
                  <div className="relative z-10 mx-4 mb-2 bg-yellow-500/10 border border-yellow-500/50 text-yellow-400 text-center py-2 rounded-lg text-sm font-bold animate-pulse shadow-[0_0_20px_rgba(234,179,8,0.1)]">
                      ‚ö†Ô∏è PAS GESPEELD! Volgende punten tellen x{multiplier}!
                  </div>
              )}

              <div className="relative z-10 flex-grow overflow-y-auto px-4 pb-20 space-y-3 mask-image-b no-scrollbar">
                {history.length === 0 ? (
                  <div className="text-center text-slate-600 mt-20 flex flex-col items-center">
                     <div className="text-4xl mb-4 opacity-50">üé≤</div>
                     <p className="font-medium">Nog geen rondes gespeeld.</p>
                  </div>
                ) : (
                  history.map(round => {
                     const isPass = round.gameType === 'PAS';
                     return (
                    <div key={round.id} className={`
                        relative p-4 rounded-xl border shadow-sm flex justify-between items-center gap-3 transition-all hover:scale-[1.01]
                        ${isPass ? 'bg-slate-800/50 border-slate-700 opacity-75' : 'bg-slate-800 border-slate-700'}
                    `}>
                       <div className="flex-1">
                          <div className="flex items-center gap-2">
                             <span className={`font-bold text-sm sm:text-base ${isPass ? 'text-slate-400 italic' : 'text-white'}`}>
                                {GAME_LABELS[round.gameType]}
                             </span>
                             {round.multiplier > 1 && (
                                 <span className="bg-yellow-500 text-slate-900 text-[10px] font-bold px-1.5 py-0.5 rounded">x{round.multiplier}</span>
                             )}
                          </div>
                          
                          {!isPass && (
                          <div className="text-slate-400 text-xs mt-1 flex flex-wrap gap-1 items-center">
                            <span className="text-sky-400 font-semibold">{players[round.bidder].name}</span>
                            {round.partner !== undefined && <span>& <span className="text-sky-400 font-semibold">{players[round.partner].name}</span></span>}
                            <span className="text-slate-600 mx-1">|</span>
                            {['MISERIE','OPEN_MISERIE'].includes(round.gameType) 
                               ? (round.success ? <span className="text-emerald-400 font-bold">Gelukt</span> : <span className="text-rose-400 font-bold">Mislukt</span>)
                               : (<span>{round.tricks} slagen ({round.success ? <span className="text-emerald-400">Ok</span> : <span className="text-rose-400">Niet Ok</span>})</span>)
                            }
                          </div>
                          )}
                       </div>
                       
                       <div className={`text-lg font-mono font-bold px-3 py-1 rounded-lg min-w-[60px] text-center
                          ${isPass ? 'bg-slate-700 text-slate-500' : 'bg-slate-900 text-slate-200'}
                       `}>
                          {round.points}
                       </div>
                    </div>
                  )})
                )}
              </div>

              <div className="absolute bottom-6 left-4 right-4 z-20 flex gap-3">
                <button 
                  onClick={handlePass}
                  className="bg-slate-700/90 backdrop-blur-md hover:bg-slate-600 text-slate-300 font-bold px-4 py-4 rounded-2xl shadow-lg border border-slate-600 transition-transform active:scale-95 flex flex-col items-center justify-center min-w-[80px]"
                >
                  <span className="text-xl mb-1">‚è≠Ô∏è</span>
                  <span className="text-[10px] uppercase tracking-wide">Pas</span>
                </button>

                <button 
                  onClick={() => setScreen('ADD_ROUND')}
                  className="flex-1 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-500 hover:to-indigo-500 text-white font-bold py-4 rounded-2xl shadow-xl shadow-blue-900/30 border border-blue-400/20 transition-transform active:scale-95 flex items-center justify-center gap-3"
                >
                  <PlusIcon />
                  <span className="text-lg uppercase tracking-wide">Nieuwe Ronde</span>
                </button>
              </div>
            </div>
            );
          };

          const renderAddRound = () => {
            const isPartnership = ['VRAAG', 'TROEL'].includes(selectedGame);
            const isMiserie = ['MISERIE', 'OPEN_MISERIE'].includes(selectedGame);
            const isFixedTricks = ['SOLO', 'SOLO_SLIM', 'ABONDANCE_9', 'ABONDANCE_10', 'ABONDANCE_11', 'ABONDANCE_12'].includes(selectedGame);

            return (
              <div className="fixed inset-0 bg-slate-900 z-50 flex flex-col font-sans">
                {/* Top Navigation */}
                <div className="p-4 flex justify-between items-center bg-slate-900/95 border-b border-white/5 shrink-0 z-50 backdrop-blur-sm shadow-lg">
                  <button onClick={() => setScreen('SCOREBOARD')} className="text-slate-400 hover:text-white font-medium px-2 transition-colors">Annuleren</button>
                  <h2 className="text-white font-bold text-lg tracking-wide">Ronde Toevoegen</h2>
                  <div className="w-16"></div> 
                </div>

                {/* Scrollable Content Area */}
                <div className="flex-grow overflow-y-auto p-4 md:p-6 w-full max-w-2xl mx-auto space-y-8 no-scrollbar">
                  
                  {/* Game Type Grid */}
                  <div className="space-y-3">
                    <label className="text-slate-400 text-xs font-bold uppercase tracking-wider ml-1">Kies Speltype</label>
                    <div className="grid grid-cols-2 sm:grid-cols-3 gap-3">
                      {Object.keys(GAME_LABELS).filter(k => k !== 'PAS').map(key => (
                        <button
                          key={key}
                          onClick={() => {
                             setSelectedGame(key);
                             if (key === 'VRAAG' || key === 'TROEL') setTricks(8);
                             if (key === 'ALLEEN') setTricks(5);
                             if (key === 'SOLO' || key === 'SOLO_SLIM') setTricks(13);
                          }}
                          className={`
                            p-4 rounded-xl text-sm font-bold transition-all duration-200 border relative overflow-hidden group
                            ${selectedGame === key 
                               ? 'bg-blue-600 border-blue-500 text-white shadow-lg shadow-blue-500/25 scale-[1.02]' 
                               : 'bg-slate-800 border-slate-700 text-slate-300 hover:bg-slate-750 hover:border-slate-500'}
                          `}
                        >
                          <span className="relative z-10">{GAME_LABELS[key]}</span>
                          {selectedGame === key && <div className="absolute inset-0 bg-gradient-to-br from-white/10 to-transparent z-0"></div>}
                        </button>
                      ))}
                    </div>
                  </div>

                  {/* Players Selection Grid */}
                  <div className="space-y-6">
                    <div className="space-y-2">
                       <label className="text-slate-400 text-xs font-bold uppercase tracking-wider ml-1">
                          Bieder (Wie speelt?)
                       </label>
                       <div className="grid grid-cols-2 gap-3">
                         {players.map(p => (
                           <button
                             key={p.id}
                             onClick={() => setBidder(p.id)}
                             className={`
                               p-4 rounded-xl border font-bold transition-all duration-200 flex items-center justify-center gap-2
                               ${bidder === p.id 
                                 ? 'bg-amber-600 border-amber-500 text-white shadow-lg shadow-amber-600/20 ring-2 ring-amber-500/20' 
                                 : 'bg-slate-800 border-slate-700 text-slate-300 hover:bg-slate-750'}
                             `}
                           >
                             {bidder === p.id && <span className="text-sm">üëë</span>}
                             {p.name}
                           </button>
                         ))}
                       </div>
                    </div>

                    {isPartnership && (
                       <div className="space-y-2 animate-fade-in">
                         <label className="text-slate-400 text-xs font-bold uppercase tracking-wider ml-1">
                            Partner (Wie gaat mee?)
                         </label>
                         <div className="grid grid-cols-2 gap-3">
                           {players.map(p => {
                             const isBidder = p.id === bidder;
                             const isSelected = partner === p.id;
                             return (
                               <button
                                 key={p.id}
                                 disabled={isBidder}
                                 onClick={() => setPartner(p.id)}
                                 className={`
                                   p-4 rounded-xl border font-bold transition-all duration-200 flex items-center justify-center gap-2
                                   ${isBidder ? 'opacity-30 cursor-not-allowed bg-slate-900 border-transparent' : ''}
                                   ${!isBidder && isSelected 
                                     ? 'bg-emerald-600 border-emerald-500 text-white shadow-lg shadow-emerald-600/20 ring-2 ring-emerald-500/20' 
                                     : (!isBidder && 'bg-slate-800 border-slate-700 text-slate-300 hover:bg-slate-750')}
                                 `}
                               >
                                 {isSelected && !isBidder && <span className="text-sm">ü§ù</span>}
                                 {p.name}
                               </button>
                             );
                           })}
                         </div>
                       </div>
                    )}
                  </div>

                  {/* Result Input */}
                  <div className="bg-slate-800/50 p-6 rounded-2xl border border-slate-700/50 backdrop-blur-sm">
                     <label className="block text-slate-400 text-xs font-bold uppercase mb-6 text-center tracking-widest">Resultaat</label>
                     
                     {isMiserie ? (
                       <div className="flex gap-4">
                          <button 
                            onClick={() => setMiserieSuccess(true)}
                            className={`flex-1 p-6 rounded-2xl font-bold text-lg border-2 transition-all duration-200 transform hover:scale-[1.02] ${miserieSuccess ? 'bg-emerald-600 border-emerald-500 text-white shadow-lg shadow-emerald-500/20' : 'bg-slate-900 border-slate-700 text-slate-500 hover:bg-slate-800'}`}
                          >
                            GELUKT
                          </button>
                          <button 
                            onClick={() => setMiserieSuccess(false)}
                            className={`flex-1 p-6 rounded-2xl font-bold text-lg border-2 transition-all duration-200 transform hover:scale-[1.02] ${!miserieSuccess ? 'bg-rose-600 border-rose-500 text-white shadow-lg shadow-rose-500/20' : 'bg-slate-900 border-slate-700 text-slate-500 hover:bg-slate-800'}`}
                          >
                            MISLUKT
                          </button>
                       </div>
                     ) : (
                       <div className="space-y-8">
                          <div className="flex justify-between items-center text-white font-mono font-bold select-none">
                            <button onClick={() => setTricks(Math.max(0, tricks-1))} className="w-14 h-14 rounded-full bg-slate-700 hover:bg-slate-600 flex items-center justify-center text-2xl shadow transition-colors">-</button>
                            <div className="flex flex-col items-center">
                                <span className="text-5xl">{tricks}</span>
                                <span className="text-xs text-slate-500 uppercase tracking-widest mt-1">Slagen</span>
                            </div>
                            <button onClick={() => setTricks(Math.min(13, tricks+1))} className="w-14 h-14 rounded-full bg-slate-700 hover:bg-slate-600 flex items-center justify-center text-2xl shadow transition-colors">+</button>
                          </div>
                          
                          <input 
                            type="range" 
                            min="0" 
                            max="13" 
                            value={tricks} 
                            onChange={(e) => setTricks(Number(e.target.value))}
                            className="w-full h-3 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-blue-500"
                          />
                          
                          {!isFixedTricks && (
                            <div className={`text-center text-sm font-medium py-2 rounded-lg ${tricks >= (selectedGame === 'VRAAG' || selectedGame === 'TROEL' ? 8 : 5) ? 'text-emerald-400 bg-emerald-400/10' : 'text-rose-400 bg-rose-400/10'}`}>
                               Minimaal vereist: {selectedGame === 'VRAAG' || selectedGame === 'TROEL' ? 8 : 5}
                            </div>
                          )}
                       </div>
                     )}
                  </div>
                </div>

                {/* Footer Button - In Flex Flow */}
                <div className="p-4 bg-slate-900 border-t border-white/5 shrink-0 z-40 shadow-2xl">
                   <div className="max-w-2xl mx-auto w-full">
                     <button 
                        onClick={addRound}
                        className="w-full bg-gradient-to-r from-emerald-500 to-teal-600 hover:from-emerald-400 hover:to-teal-500 text-white font-bold py-4 rounded-2xl shadow-xl shadow-emerald-500/20 text-lg uppercase tracking-wide transform transition-transform active:scale-[0.98]"
                    >
                        Bereken & Opslaan
                    </button>
                   </div>
                </div>
              </div>
            );
          };

          const renderFinish = () => {
            const sorted = [...players].sort((a, b) => b.score - a.score);
            const winner = sorted[0];

            return (
              <div className="flex flex-col items-center justify-center min-h-screen bg-slate-900 text-white p-6 relative overflow-hidden">
                <div className="absolute inset-0 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-yellow-900/10 via-slate-900 to-slate-900 z-0"></div>
                
                <div className="z-10 text-center w-full max-w-lg animate-fade-in-up">
                   <div className="mb-6 flex justify-center">
                       <div className="p-4 bg-gradient-to-br from-yellow-400 to-amber-600 rounded-full shadow-[0_0_40px_rgba(251,191,36,0.4)] animate-bounce">
                          <CrownIcon />
                       </div>
                   </div>
                   
                   <h2 className="text-2xl text-yellow-500 font-bold mb-2 uppercase tracking-[0.2em]">Winnaar</h2>
                   <h1 className="text-6xl font-black text-white mb-10 drop-shadow-2xl">{winner.name}</h1>
                   
                   <div className="bg-white/5 backdrop-blur-md rounded-3xl p-6 shadow-2xl border border-white/10 w-full mb-10">
                      {sorted.map((p, idx) => (
                        <div key={p.id} className="flex justify-between items-center py-4 border-b border-white/5 last:border-0">
                           <div className="flex items-center gap-4">
                              <span className={`w-8 h-8 flex items-center justify-center rounded-lg font-bold text-sm ${idx === 0 ? 'bg-yellow-500 text-slate-900' : 'bg-slate-700 text-slate-400'}`}>
                                {idx + 1}
                              </span>
                              <span className={`text-lg font-medium ${idx === 0 ? 'text-white' : 'text-slate-300'}`}>{p.name}</span>
                           </div>
                           <span className={`font-mono font-bold text-xl ${p.score >= 0 ? 'text-emerald-400' : 'text-rose-400'}`}>
                              {p.score > 0 ? '+' : ''}{p.score}
                           </span>
                        </div>
                      ))}
                   </div>

                   <button 
                     onClick={resetGame}
                     className="bg-slate-700 hover:bg-slate-600 text-white px-8 py-4 rounded-full font-bold text-lg shadow-lg border border-slate-600 transition-all hover:scale-105"
                   >
                     Nieuw Spel Starten
                   </button>
                </div>
              </div>
            );
          };

          switch(screen) {
            case 'SETUP': return renderSetup();
            case 'SCOREBOARD': return renderScoreboard();
            case 'ADD_ROUND': return renderAddRound();
            case 'FINISH': return renderFinish();
            default: return renderSetup();
          }
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>